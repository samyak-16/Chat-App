ğŸ“„ routesFlow.txt â€” API & Socket Route Structure for Chat App

âœ… ALL ROUTES use `authMiddleware` to extract and verify user from JWT.
User info comes from Auth Service and is not duplicated.

=======================================
ğŸŒ REST API ROUTES (Express/Mongoose)
=======================================

ğŸ“ /api/messages  â†’ messageController.js

POST    /send
  â†’ Send a new message to a chat

GET     /:chatId
  â†’ Get messages of a specific chat (with pagination support)

POST    /:msgId/seen
  â†’ Mark a message as seen by the current user

POST    /:msgId/delete
  â†’ Soft delete a message for current user only


ğŸ“ /api/chats  â†’ chatController.js

POST    /private
  â†’ Start or get a private chat between two users

POST    /group
  â†’ Create a new group chat with participants

GET     /
  â†’ Get all chats of current user (for sidebar)

GET     /:chatId
  â†’ Get details of a specific chat (participants, name, etc.)

DELETE  /:chatId
  â†’ Leave or delete a chat (depends on chat type & role)


ğŸ“ /api/chats/:chatId â†’ groupChatController.js

POST    /add
  â†’ Add one or more users to a group chat

POST    /remove
  â†’ Remove user(s) from group chat

POST    /promote
  â†’ Promote a user to group admin

POST    /demote
  â†’ Demote a user from group admin


ğŸ“ /api/user â†’ chatUserController.js

GET     /me
  â†’ Get ChatUser profile (nickname, muted chats, etc.)

POST    /nickname
  â†’ Set or update nickname used inside chat app

POST    /mute/:chatId
  â†’ Mute or unmute a chat (toggle behavior)


=======================================
âš¡ SOCKET.IO EVENTS (Real-time layer)
=======================================

ğŸ”Œ message:send
  â†’ User sends message in a chat (emitted from client)

ğŸ“¤ message:received
  â†’ Server emits to other users when a message is sent

ğŸ“¬ message:seen
  â†’ User marks message as read

âœï¸ user:typing
  â†’ Emit typing started/stopped in a chat

ğŸŸ¢ user:status
  â†’ Toggle online/offline or update lastSeen

(Handled in socketController.js)

=======================================
ğŸ—ƒ DB Collections
=======================================
- User (Auth Service)
- Chat
- Message
- ChatUser

References:
- Chat.participants â†’ [userId]
- Message.senderId â†’ userId
- ChatUser.userId â†’ userId
- All userId values point to Auth Service users.
